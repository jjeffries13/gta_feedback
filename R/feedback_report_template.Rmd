---
title: "Student Feedback Report"
author: ' '
date: "`r format(Sys.time(), '%b %d, %Y')`"
output: pdf_document
fontsize: 12pt
sansfont: Calibri Light
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(pacman)

p_load("tidyverse", "here", "Hmisc")

report_data_numeric <- read_csv(file = here("./data/gta_report_data.csv"))
report_data_full <- read_csv(file = here("./data/gta_data_clean.csv"))

descriptives <- report_data_numeric |>
  select(contains("q")) |>
  pivot_longer(cols = contains("q"),
               names_to = "item",
               values_to = "values") |>
  group_by(item) |>
  summarise(mean = round(mean(values, na.rm = T), 2),
            sd = round(sd(values, na.rm = T), 2),
            median = median(values),
            min = min(values, na.rm = T),
            max = max(values), na.rm = T) |>
  as.data.frame()

report_data_long <- report_data_full |>
  select(contains("q")) |>
  pivot_longer(cols = contains("q"),
               names_to = "item",
               values_to = "values") |>
  group_by(item, values) |>
  count() |>
  ungroup() |>
  group_by(item) |>
  mutate(
    percent = 100 * n / sum(n),
    percent = round(percent, 0),
    bar_text = paste0(percent, "%"),
    values = fct_relevel(values, c("Strongly disagree",
                                   "Somewhat disagree",
                                   "Neither agree nor disagree",
                                   "Somewhat agree",
                                   "Strongly agree"))) |>
  arrange(item, values)

palette <- c("Strongly disagree" = "#613245",
             "Somewhat disagree" = "#514c67", 
             "Neither agree nor disagree" = "#2d8b9b",
             "Somewhat agree" = "#28988a",
             "Strongly agree" = "#1eb267")
```

### Overview

The following report contains descriptive statistics, data visualizations, and qualitative feedback from students in your `r report_data_numeric$course_id` class. Students were asked to respond to **nine questions** regarding the degree to which they believe aspects of your classroom to be successful. The following pages of feedback are separated by these aspects. These data were collected via a secure Qualtrics link that maintains student anonymity. 

Below are additional technical properties of this report.

#### Survey Items

Each item stem begins with the phrase "*My instructor..*" but differ depending on the element of their classroom experience. The student classroom experience was captured using the following domains:

-   Clarity of purpose of class and class activities
-   Explanation of class materials
-   Extent to which atmosphere encourages learning
-   Student excitement and interest in content
-   Mutual respect and relation to students
-   Explanation of class expectations
-   Clarity of performance evaluation
-   Degree of match between learning evaluations and course goals
-   How meaningful instructor feedback is to students

#### Response Scale

The five-point scale starts at *Strongly disagree* to *Strongly agree* with a neutral point, *Neither agree nor disagree*, in the middle. Below are how these responses were coded numerically.

| **Strongly disagree** | **Somewhat disagree** | **Neither agree nor disagree** | **Somewhat agree** | **Strongly agree** |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|           1           |           2           |               3                |         4          |         5          |

Additional space was given to students to explain their feedback in words. This text will follow each each question below.

\newpage

# Item 1

```{r, include = F}
q1mean <- descriptives$mean[1]
q1sd <- descriptives$sd[1]
q1median <- descriptives$median[1]
q1max <- descriptives$max[1]
q1min <- descriptives$min[1]
```

#### *My instructor.. Makes clear the purposes of each class session and learning activity*

-   On average, your students rated this domain as *M* = `r q1mean` (*SD* = `r q1sd`) out of 5
    -   Median = `r q1median`
-   Scores for this domain ranged from `r q1max` to `r q1min`

------------------------------------------------------------------------

## Percentage Bar Chart of Responses for Item 1

```{r}
report_data_long |>
  filter(str_detect(item, "q1")) |>
  ggplot(aes(y = percent, x = values, fill = values)) +
  geom_col(width = 0.8) +
  geom_text(aes(label = bar_text, vjust = -.5), family = "serif") +
  scale_y_continuous(limits = c(0, 100), labels = paste0(seq(0, 100, 25), "%")) +
  scale_fill_manual(values = palette) +
  theme_classic() +
  theme(plot.margin = unit(rep(0.7, 4), "cm"),
        text = element_text(family = "serif"),
        plot.title = element_blank(),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(vjust = -0.5, size = 12),
        axis.title.y = element_text(size = 12),
        legend.position = "none",
        aspect.ratio = .5) +
  labs(y = "Percent", x = "Response")
```

------------------------------------------------------------------------

## Written Feedback

```{r, comment=""}
report_data_full |>
  drop_na(r1) |>
  select(r1) |>
  unlist(use.names = FALSE)
```

\newpage

# Item 2

```{r, include = F}
q2mean <- descriptives$mean[2]
q2sd <- descriptives$sd[2]
q2median <- descriptives$median[2]
q2max <- descriptives$max[2]
q2min <- descriptives$min[2]
```

#### *My instructor.. Clarifies material that needs explanation*

-   On average, your students rated this domain as *M* = `r q2mean` (*SD* = `r q1sd`) out of 5
    -   Median = `r q2median`
-   Scores for this domain ranged from `r q2max` to `r q2min`

------------------------------------------------------------------------

## Percentage Bar Chart of Responses for Item 2

```{r}
report_data_long |>
  filter(str_detect(item, "q2")) |>
  ggplot(aes(y = percent, x = values, fill = values)) +
  geom_col(width = 0.8) +
  geom_text(aes(label = bar_text, vjust = -.5), family = "serif") +
  scale_y_continuous(limits = c(0, 100), labels = paste0(seq(0, 100, 25), "%")) +
  scale_fill_manual(values = palette) +
  theme_classic() +
  theme(plot.margin = unit(rep(0.7, 4), "cm"),
        text = element_text(family = "serif"),
        plot.title = element_blank(),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(vjust = -0.5, size = 12),
        axis.title.y = element_text(size = 12),
        legend.position = "none",
        aspect.ratio = .5) +
  labs(y = "Percent", x = "Response")
```

------------------------------------------------------------------------

## Written Feedback

```{r, comment=""}
report_data_full |>
  drop_na(r2) |>
  select(r2) |>
  unlist(use.names = FALSE)
```

\newpage

# Item 3

```{r, include = F}
q3mean <- descriptives$mean[3]
q3sd <- descriptives$sd[3]
q3median <- descriptives$median[3]
q3max <- descriptives$max[3]
q3min <- descriptives$min[3]
```

#### *My instructor.. Maintains an atmosphere that actively encourages learning*

-   On average, your students rated this domain as *M* = `r q3mean` (*SD* = `r q3sd`) out of 5
    -   Median = `r q3median`
-   Scores for this domain ranged from `r q3max` to `r q3min`

------------------------------------------------------------------------

## Percentage Bar Chart of Responses for Item 3

```{r}
report_data_long |>
  filter(str_detect(item, "q3")) |>
  ggplot(aes(y = percent, x = values, fill = values)) +
  geom_col(width = 0.8) +
  geom_text(aes(label = bar_text, vjust = -.5), family = "serif") +
  scale_y_continuous(limits = c(0, 100), labels = paste0(seq(0, 100, 25), "%")) +
  scale_fill_manual(values = palette) +
  theme_classic() +
  theme(plot.margin = unit(rep(0.7, 4), "cm"),
        text = element_text(family = "serif"),
        plot.title = element_blank(),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(vjust = -0.5, size = 12),
        axis.title.y = element_text(size = 12),
        legend.position = "none",
        aspect.ratio = .5) +
  labs(y = "Percent", x = "Response")
```

------------------------------------------------------------------------

## Written Feedback

```{r, comment=""}
report_data_full |>
  drop_na(r3) |>
  select(r3) |>
  unlist(use.names = FALSE)
```

\newpage

# Item 4

```{r, include = F}
q4mean <- descriptives$mean[4]
q4sd <- descriptives$sd[4]
q4median <- descriptives$median[4]
q4max <- descriptives$max[4]
q4min <- descriptives$min[4]
```

#### *My instructor.. Inspires excitement or interest in the content of the course*

-   On average, your students rated this domain as *M* = `r q4mean` (*SD* = `r q4sd`) out of 5
    -   Median = `r q4median`
-   Scores for this domain ranged from `r q4max` to `r q4min`

------------------------------------------------------------------------

## Percentage Bar Chart of Responses for Item 4

```{r}
report_data_long |>
  filter(str_detect(item, "q4")) |>
  ggplot(aes(y = percent, x = values, fill = values)) +
  geom_col(width = 0.8) +
  geom_text(aes(label = bar_text, vjust = -.5), family = "serif") +
  scale_y_continuous(limits = c(0, 100), labels = paste0(seq(0, 100, 25), "%")) +
  scale_fill_manual(values = palette) +
  theme_classic() +
  theme(plot.margin = unit(rep(0.7, 4), "cm"),
        text = element_text(family = "serif"),
        plot.title = element_blank(),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(vjust = -0.5, size = 12),
        axis.title.y = element_text(size = 12),
        legend.position = "none",
        aspect.ratio = .5) +
  labs(y = "Percent", x = "Response")
```

------------------------------------------------------------------------

## Written Feedback

```{r, comment=""}
report_data_full |>
  drop_na(r4) |>
  select(r4) |>
  unlist(use.names = FALSE)
```

\newpage

# Item 5

```{r, include = F}
q5mean <- descriptives$mean[5]
q5sd <- descriptives$sd[5]
q5median <- descriptives$median[5]
q5max <- descriptives$max[5]
q5min <- descriptives$min[5]
```

#### *My instructor.. Promotes mutual respect by relating to us students*

-   On average, your students rated this domain as *M* = `r q5mean` (*SD* = `r q5sd`) out of 5
    -   Median = `r q5median`
-   Scores for this domain ranged from `r q5max` to `r q5min`

------------------------------------------------------------------------

## Percentage Bar Chart of Responses for Item 5

```{r}
report_data_long |>
  filter(str_detect(item, "q5")) |>
  ggplot(aes(y = percent, x = values, fill = values)) +
  geom_col(width = 0.8) +
  geom_text(aes(label = bar_text, vjust = -.5), family = "serif") +
  scale_y_continuous(limits = c(0, 100), labels = paste0(seq(0, 100, 25), "%")) +
  scale_fill_manual(values = palette) +
  theme_classic() +
  theme(plot.margin = unit(rep(0.7, 4), "cm"),
        text = element_text(family = "serif"),
        plot.title = element_blank(),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(vjust = -0.5, size = 12),
        axis.title.y = element_text(size = 12),
        legend.position = "none",
        aspect.ratio = .5) +
  labs(y = "Percent", x = "Response")
```

------------------------------------------------------------------------

## Written Feedback

```{r, comment=""}
report_data_full |>
  drop_na(r5) |>
  select(r5) |>
  unlist(use.names = FALSE)
```

\newpage

# Item 6

```{r, include = F}
q6mean <- descriptives$mean[6]
q6sd <- descriptives$sd[6]
q6median <- descriptives$median[6]
q6max <- descriptives$max[6]
q6min <- descriptives$min[6]
```

#### *My instructor.. Explains what is expected from each student*

-   On average, your students rated this domain as *M* = `r q6mean` (*SD* = `r q6sd`) out of 5
    -   Median = `r q6median`
-   Scores for this domain ranged from `r q6max` to `r q6min`

------------------------------------------------------------------------

## Percentage Bar Chart of Responses for Item 6

```{r}
report_data_long |>
  filter(str_detect(item, "q6")) |>
  ggplot(aes(y = percent, x = values, fill = values)) +
  geom_col(width = 0.8) +
  geom_text(aes(label = bar_text, vjust = -.5), family = "serif") +
  scale_y_continuous(limits = c(0, 100), labels = paste0(seq(0, 100, 25), "%")) +
  scale_fill_manual(values = palette) +
  theme_classic() +
  theme(plot.margin = unit(rep(0.7, 4), "cm"),
        text = element_text(family = "serif"),
        plot.title = element_blank(),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(vjust = -0.5, size = 12),
        axis.title.y = element_text(size = 12),
        legend.position = "none",
        aspect.ratio = .5) +
  labs(y = "Percent", x = "Response")
```

------------------------------------------------------------------------

## Written Feedback

```{r, comment=""}
report_data_full |>
  drop_na(r6) |>
  select(r6) |>
  unlist(use.names = FALSE)
```

\newpage

# Item 7

```{r, include = F}
q7mean <- descriptives$mean[7]
q7sd <- descriptives$sd[7]
q7median <- descriptives$median[7]
q7max <- descriptives$max[7]
q7min <- descriptives$min[7]
```

#### *My instructor.. Makes clear how my performance is to be evaluated*

-   On average, your students rated this domain as *M* = `r q7mean` (*SD* = `r q7sd`) out of 5
    -   Median = `r q7median`
-   Scores for this domain ranged from `r q7max` to `r q7min`

------------------------------------------------------------------------

## Percentage Bar Chart of Responses for Item 7

```{r}
report_data_long |>
  filter(str_detect(item, "q7")) |>
  ggplot(aes(y = percent, x = values, fill = values)) +
  geom_col(width = 0.8) +
  geom_text(aes(label = bar_text, vjust = -.5), family = "serif") +
  scale_y_continuous(limits = c(0, 100), labels = paste0(seq(0, 100, 25), "%")) +
  scale_fill_manual(values = palette) +
  theme_classic() +
  theme(plot.margin = unit(rep(0.7, 4), "cm"),
        text = element_text(family = "serif"),
        plot.title = element_blank(),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(vjust = -0.5, size = 12),
        axis.title.y = element_text(size = 12),
        legend.position = "none",
        aspect.ratio = .5) +
  labs(y = "Percent", x = "Response")
```

------------------------------------------------------------------------

## Written Feedback

```{r, comment=""}
report_data_full |>
  drop_na(r7) |>
  select(r7) |>
  unlist(use.names = FALSE)
```

\newpage

# Item 8

```{r, include = F}
q8mean <- descriptives$mean[8]
q8sd <- descriptives$sd[8]
q8median <- descriptives$median[8]
q8max <- descriptives$max[8]
q8min <- descriptives$min[8]
```

#### *My instructor.. Designs evaluation procedures consistent with course goals*

-   On average, your students rated this domain as *M* = `r q8mean` (*SD* = `r q8sd`) out of 5
    -   Median = `r q8median`
-   Scores for this domain ranged from `r q8max` to `r q8min`

---

## Percentage Bar Chart of Responses for Item 8

```{r}
report_data_long |>
  filter(str_detect(item, "q8")) |>
  ggplot(aes(y = percent, x = values, fill = values)) +
  geom_col(width = 0.8) +
  geom_text(aes(label = bar_text, vjust = -.5), family = "serif") +
  scale_y_continuous(limits = c(0, 100), labels = paste0(seq(0, 100, 25), "%")) +
  scale_fill_manual(values = palette) +
  theme_classic() +
  theme(plot.margin = unit(rep(0.7, 4), "cm"),
        text = element_text(family = "serif"),
        plot.title = element_blank(),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(vjust = -0.5, size = 12),
        axis.title.y = element_text(size = 12),
        legend.position = "none",
        aspect.ratio = .5) +
  labs(y = "Percent", x = "Response")
```

------------------------------------------------------------------------

## Written Feedback

```{r, comment=""}
report_data_full |>
  drop_na(r8) |>
  select(r8) |>
  unlist(use.names = FALSE)
```

\newpage

# Item 8

```{r, include = F}
q9mean <- descriptives$mean[9]
q9sd <- descriptives$sd[9]
q9median <- descriptives$median[9]
q9max <- descriptives$max[9]
q9min <- descriptives$min[9]
```

#### *My instructor.. Gives meaningful feedback on assignments*

-   On average, your students rated this domain as *M* = `r q9mean` (*SD* = `r q9sd`) out of 5
    -   Median = `r q9median`
-   Scores for this domain ranged from `r q9max` to `r q9min`

---

## Percentage Bar Chart of Responses for Item 9

```{r}
report_data_long |>
  filter(str_detect(item, "q9")) |>
  ggplot(aes(y = percent, x = values, fill = values)) +
  geom_col(width = 0.8) +
  geom_text(aes(label = bar_text, vjust = -.5), family = "serif") +
  scale_y_continuous(limits = c(0, 100), labels = paste0(seq(0, 100, 25), "%")) +
  scale_fill_manual(values = palette) +
  theme_classic() +
  theme(plot.margin = unit(rep(0.7, 4), "cm"),
        text = element_text(family = "serif"),
        plot.title = element_blank(),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.title.x = element_text(vjust = -0.5, size = 12),
        axis.title.y = element_text(size = 12),
        legend.position = "none",
        aspect.ratio = .5) +
  labs(y = "Percent", x = "Response")
```

------------------------------------------------------------------------

## Written Feedback

```{r, comment=""}
report_data_full |>
  drop_na(r9) |>
  select(r9) |>
  unlist(use.names = FALSE)
```
